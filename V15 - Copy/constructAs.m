W12=[0.51 0.39 0.09 0.01;0.15 0.43 0.37 0.05;0.05 0.25 0.60 0.10;0.02 0.09 0.23 0.66];
W23=[0.43 0.42 0.13 0.02; 0.2 0.4 0.29 0.11;0.06 0.25 0.44 0.25; 0.09 0.1 0.22 0.59];
W34=[0.85 0.15 0 0;0.415 0.395 0.17 0.02; 0.1 0.28 0.3 0.32;0.02 0.069 0.216 0.695];
W41=[0.79 0.18 0.03 0;0.33 0.47 0.17 0.03;0.06 0.28 0.42 0.24;0 0.01 0.11 0.88];

W11=W12*W23*W34*W41;
W22=W23*W34*W41*W12;
W33=W34*W41*W12*W23;
W44=W41*W12*W23*W34;


W=(W11+W22+W33+W44)./4;

WW=[(W-eye(4))';1 1 1 1];
a=[0;0;0;0;1];

solu=linsolve(WW,a);

p=solu(2)/(1-solu(1))*W(2,1)+solu(3)/(1-solu(1))*W(3,1)+solu(4)/(1-solu(1))*W(4,1);

PP=[0.95 0.05;0.22 0.78];

PPP=PP*PP*PP*PP;